# 2026-02-12 작업 요약 (Shadowforge Development Log)

## ✅ 주요 작업 내용 (Summary)

### 1. 상점 시스템 대규모 개편 (Shop Overhaul)
- **UI 복원 및 고도화**:
  - 기존의 단조로운 UI를 `GameFrame` 기반의 프리미엄 디자인(16:9)으로 복구했습니다.
  - 아이템 카드에 블러 효과 및 애니메이션을 적용하여 시각적 완성도를 높였습니다.
  - 장바구니 UI를 직관적으로 개선하고, 예상 결제 금액을 실시간으로 계산하도록 수정했습니다.
- **데이터 동기화 (Server-Authoritative)**:
  - 클라이언트(`game.store.ts`)가 아닌 서버(`items.data.ts`)를 데이터의 원천(Source of Truth)으로 설정했습니다.
  - 상점 진입 시 서버로부터 최신 가격과 메타데이터(가격 인상률 등)를 실시간으로 받아오도록 구현했습니다.
  - `ShopService`를 리팩토링하여 하드코딩을 제거하고 `items.data.ts`와 연동했습니다.
- **버그 수정**:
  - 포션 및 아이템 가격 표시 오류(0G 처리 등)를 해결했습니다.
  - 초기 게임 시작 시 포션이 1개 지급되던 버그를 수정했습니다.

### 2. 게임 밸런스 조정 (Balance Adjustments)
- **전투 보상 랜덤화**:
  - 기존: STR +1, AGI +1, POTION +1 (고정)
  - **변경**:
    - **STR**: +1 ~ +3 (랜덤)
    - **AGI**: +1 ~ +5 (랜덤)
    - **POTION**: 0 ~ 2개 (랜덤, 도박성 추가)
  - 보상 선택 UI(`VictoryOverlay`)에도 변경된 범위(예: "+1~3")를 텍스트로 명시했습니다.
- **몬스터 골드 보상 상향**:
  - 몬스터 처치 시 획득하는 골드를 대폭 상향(초반 10~20G, 후반 100G 이상)하여 상점 이용을 장려했습니다.
- **럭키 어택(Lucky Attack) 리메이크**:
  - 주사위를 1~5 → **1~6**으로 변경했습니다.
  - 잭팟(Double) 배율을 2.0배 → **3.0배**로 상향하여 "한 방"의 재미를 강화했습니다.
  - 일반 데미지 배율 공식도 상향 조정하여 리스크를 완화했습니다.

### 3. 게임 진행 로직 개선 (Game Flow)
- **보스전 선택지 제공**:
  - 5, 10, 15턴에 강제로 보스전에 돌입하던 로직을 수정했습니다.
  - 이제 유저는 **'상점'**과 **'보스전'** 중 하나를 선택할 수 있으며, 상점에서 정비를 마친 후 보스전에 도전할 수 있습니다.
- **UI 편의성**:
  - 상점 진입 전 데이터를 미리 로딩(`Pre-fetching`)하여 로딩 지연 없는 부드러운 화면 전환을 구현했습니다.

---

## 📝 파일 변경 내역 (Changelog)

### Server
- `src/services/shop.service.ts`: 상점 아이템 리스트 생성 및 가격 계산 로직 수정
- `src/services/game.service.ts`: 턴 진행(`nextTurn`) 및 선택지(`selectOption`) 로직 수정
- `src/services/battle.service.ts`: 전투 보상(`claimVictoryReward`) 및 럭키 어택(`resolveLuckFactor`) 로직 수정
- `src/data/items.data.ts`: 아이템 데이터 정의
- `src/data/monsters.data.ts`: 몬스터 골드 보상 데이터 수정

### Client
- `src/pages/ShopPage.tsx`: 상점 UI 전면 개편
- `src/stores/game.store.ts`: 상점 메타데이터 동기화 및 상태 관리 로직 업데이트
- `src/pages/TurnPage.tsx`: 보스전 선택 카드 추가 및 데이터 선로딩 로직 적용
- `src/components/battle/VictoryOverlay.tsx`: 보상 선택 버튼 텍스트 수정 (+1~N 범위 표시)

---

## 🚀 향후 계획 (Next Steps)
- 보상 선택 화면의 이모티콘을 전용 아이콘 이미지로 교체 (추후 에셋 준비 시)
- 추가적인 밸런스 피드백 반영
